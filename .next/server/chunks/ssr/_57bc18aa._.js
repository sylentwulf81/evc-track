module.exports=[9270,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored.contexts.AppRouterContext},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},45343,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(69240),e=a.i(40695),f=a.i(5522),g=a.i(17171),h=a.i(87682),i=a.i(3130),j=a.i(70106);let k=(0,j.default)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),l=(0,j.default)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),m=(0,j.default)("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);var n=a.i(1027);let o=(0,j.default)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),p=(0,j.default)("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var q=a.i(38246),r=a.i(5050),s=(0,r.createServerReference)("4024f26f6e4f2e8f45b2e2692fc8e65b112e5c32cb",r.callServer,void 0,r.findSourceMapURL,"updateProfile"),t=a.i(29163),u=(0,r.createServerReference)("00fa75ca9b62b0091512d0f293da094299feb7af98",r.callServer,void 0,r.findSourceMapURL,"getChargingSessions"),v=a.i(77577),w=a.i(23292),x=a.i(69590);let y="evc_battery_capacity",z="evc_home_rate";function A(){let{t:a,language:j,setLanguage:r}=(0,x.useLanguage)(),[A,B]=(0,c.useState)(null),[C,D]=(0,c.useState)(!0),[E,F]=(0,c.useState)(!1),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(""),[K,L]=(0,c.useState)("JPY"),M=(0,d.createClient)();(0,c.useEffect)(()=>{(async()=>{let{data:{user:a}}=await M.auth.getUser();if(B(a),a){let a=await (0,t.getProfile)();a&&(H(a.battery_capacity?.toString()??""),J(a.home_rate?.toString()??""),L(a.currency||"JPY"))}else{let a=localStorage.getItem(y),b=localStorage.getItem(z),c=(0,v.getLocalCurrency)();a&&H(a),b&&J(b),c&&L(c)}D(!1)})()},[M]);let N=async b=>{b.preventDefault(),F(!0);try{if(A){let b=new FormData;b.append("batteryCapacity",G),b.append("homeRate",I),b.append("currency",K);let c=await s(b);if(c.error)throw Error(c.error);w.toast.success(a("common.success"))}else localStorage.setItem(y,G),localStorage.setItem(z,I),(0,v.setLocalCurrency)(K),w.toast.success(a("common.success"))}catch(b){w.toast.error(b.message||a("common.error"))}finally{F(!1)}},O=async()=>{try{let b=[];if(!(b=A?await u():(0,v.getLocalSessions)())||0===b.length)return void w.toast.error(a("history.noData"));let c=["Date",`${a("common.cost")} (${K})`,a("forms.startPercent"),a("forms.endPercent"),"kWh",a("forms.type")],d=b.map(a=>[new Date(a.charged_at).toLocaleString(),a.cost,a.start_percent,a.end_percent,a.kwh||"",a.charge_type||"standard"]),e=[c.join(","),...d.map(a=>a.join(","))].join("\n"),f=new Blob([e],{type:"text/csv;charset=utf-8;"}),g=URL.createObjectURL(f),h=document.createElement("a");h.setAttribute("href",g),h.setAttribute("download",`ev_charging_data_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(h),h.click(),document.body.removeChild(h)}catch(b){console.error(b),w.toast.error(a("common.error"))}};return C?(0,b.jsx)("div",{className:"min-h-screen bg-background flex items-center justify-center",children:(0,b.jsx)(n.Zap,{className:"h-8 w-8 animate-pulse text-primary"})}):(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-primary/5 p-4 pb-24",children:(0,b.jsxs)("div",{className:"container max-w-lg mx-auto space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-6",children:[(0,b.jsx)(q.default,{href:"/",children:(0,b.jsx)(e.Button,{variant:"ghost",size:"icon",className:"rounded-full",children:(0,b.jsx)(k,{className:"h-5 w-5"})})}),(0,b.jsx)("h1",{className:"text-xl font-bold",children:a("settings.title")})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-full",children:(0,b.jsx)(p,{className:"h-5 w-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.CardTitle,{children:a("common.language")}),(0,b.jsx)(i.CardDescription,{children:"Select your preferred language"})]})]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsx)("div",{className:"space-y-2",children:(0,b.jsxs)(h.Select,{value:j,onValueChange:a=>r(a),children:[(0,b.jsx)(h.SelectTrigger,{id:"language",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select language"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"en",children:"English"}),(0,b.jsx)(h.SelectItem,{value:"es",children:"Español"}),(0,b.jsx)(h.SelectItem,{value:"ja",children:"日本語"})]})]})})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-full",children:(0,b.jsx)(m,{className:"h-5 w-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.CardTitle,{children:a("settings.vehicleProfile")}),(0,b.jsx)(i.CardDescription,{children:a("settings.vehicleProfileDesc")})]})]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"currency",children:a("common.currency")}),(0,b.jsx)("div",{className:"relative",children:(0,b.jsxs)(h.Select,{value:K,onValueChange:L,children:[(0,b.jsx)(h.SelectTrigger,{id:"currency",children:(0,b.jsx)(h.SelectValue,{placeholder:"Select currency"})}),(0,b.jsxs)(h.SelectContent,{children:[(0,b.jsx)(h.SelectItem,{value:"JPY",children:"JPY (¥)"}),(0,b.jsx)(h.SelectItem,{value:"USD",children:"USD ($)"}),(0,b.jsx)(h.SelectItem,{value:"EUR",children:"EUR (€)"}),(0,b.jsx)(h.SelectItem,{value:"GBP",children:"GBP (£)"})]})]})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(g.Label,{htmlFor:"batteryCapacity",children:[a("settings.batteryCapacity")," (kWh)"]}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Input,{id:"batteryCapacity",type:"number",step:"0.1",placeholder:"e.g. 75.0",value:G,onChange:a=>H(a.target.value)}),(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-muted-foreground",children:"kWh"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a("settings.batteryCapacityDesc")})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(g.Label,{htmlFor:"homeRate",children:a("settings.homeRate")}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(f.Input,{id:"homeRate",type:"number",step:"0.01",placeholder:"e.g. 30.00",value:I,onChange:a=>J(a.target.value)}),(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-muted-foreground",children:"/kWh"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a("settings.homeRateDesc")})]}),(0,b.jsx)(e.Button,{type:"submit",className:"w-full",disabled:E,children:E?a("common.loading"):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(l,{className:"mr-2 h-4 w-4"})," ",a("common.save")]})})]})})]}),(0,b.jsxs)(i.Card,{children:[(0,b.jsx)(i.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("div",{className:"p-2 bg-primary/10 rounded-full",children:(0,b.jsx)(o,{className:"h-5 w-5 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(i.CardTitle,{children:a("settings.dataManagement")}),(0,b.jsx)(i.CardDescription,{children:a("settings.exportData")})]})]})}),(0,b.jsx)(i.CardContent,{children:(0,b.jsxs)(e.Button,{variant:"outline",className:"w-full",onClick:O,children:[(0,b.jsx)(o,{className:"mr-2 h-4 w-4"})," ",a("settings.exportData")]})})]}),!A&&(0,b.jsxs)("div",{className:"text-center p-4 rounded-lg bg-muted/50 text-sm text-muted-foreground",children:[(0,b.jsx)("p",{children:a("settings.signInToSync")}),(0,b.jsx)(q.default,{href:"/auth/login",className:"text-primary hover:underline mt-2 inline-block",children:"Sign In"})]})]})})}a.s(["default",()=>A],45343)}];

//# sourceMappingURL=_57bc18aa._.js.map